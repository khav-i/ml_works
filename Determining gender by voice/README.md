# Модель определения пола по голосу на алгоритме решающего дерева

## Легенда
Начнём немного издалека. Представьте, что вы общаетесь с незнакомым человеком по телефону или сидя к нему спиной.
Сможете ли вы по нескольким фразам понять, какого пола ваш собеседник? В большинстве случаев это будет лёгкой задачей.
Но задумывались ли вы, как ваш мозг определяет пол человека по голосу?

Всё очень просто: женские и мужские голоса заметно различаются по акустическим свойствам.
Есть существенные физиологические различия, подтверждённые научно и активно используемые как в общественной жизни,
так и технических устройствах. Они обусловлены небольшими различиями в строении речевого аппарата мужчины и женщины,
которые формируются с возрастом. Эти различия проявляются в частотах звука, тембре и громкости.

Поэтому когда вы слышите незнакомый голос, ваш мозг на основе его акустических свойств и уже заранее заготовленных 
паттернов в вашей памяти определяет пол человека.

Почему бы нам не обучить модель машинного обучения классифицировать людей на мужчин и женщин по их голосу? Системе
идентификации пола по голосу, основанной на такой модели, можно найти применение во многих областях — от
маркетинга до интегрирования в системы безопасности.

На Kaggle можно найти множество датасетов для решения этой задачи. Большинство из них состоят из больших массивов
размеченных аудиофайлов, обработку которых составители датасетов возлагают на исследователей.

Мы пока что возьмем для решения данной задачи уже готовый датасет, в котором все преобразования аудиоинформации в числовой
табличный формат уже произведены.

## Данные 

Оригинальную страницу датасета на Kaggle с подробным описанием задачи можно посмотреть [здесь](https://www.kaggle.com/datasets/primaryobjects/voicegender).

Набор данных состоит из 3 168 записанных образцов голоса мужчин и женщин. Образцы предварительно обрабатываются
с помощью акустического анализа на языке программирования R с использованием специальных библиотек в диапазоне частот
0-280 Гц (диапазон человеческого голоса). Если вкратце, в результате обработки звук на аудиозаписи оцифровывается и
преобразуется в числовую последовательность частот, из которой извлекаются различные статистические характеристики,
например средняя частота, с которой говорит спикер на аудиозаписи, или частота с наибольшей энергией и так далее.

В столбцах таблицы содержатся статические характеристики для каждой из аудиозаписей, вычисленные на основе акустических свойств.

## Содержание

Работа состоит из двух небольших частей:
 - Обзор данных;
 - Моделирование.

В части моделирования было обучено несколько алгоритмов решающего дерева, отличающихся по глубине и наличию
оптимизации гиперпараметров.

## Результат

Оценка качества обученных моделей проводилась по метрике accuracy. Наилучшее значение метрики на тестовой выборке
было получено у модели с дефолтными гиперпараметрами (без ограничений): 0,973. Оптимизированная модель уступает 
лишь немногим: 0,97.

Мы пожертвовали тремя тысячными в значении метрики, но в рамках задачи из реальной коммерческой практики мы,
придерживаясь тех же принципов, могли сэкономить не расстраченные на пустое ожидание драгоценные часы, дни, недели - мы выиграли бы время для прочей более полезной деятельности.

В конце работы были визуализированы в виде диаграммы значимости признаков для составления алгоритмом решающих правил.

## Ноутбук с проделанной работой доступен [по ссылке](https://github.com/khav-i/ml_works/blob/master/Determining%20gender%20by%20voice/determining_gender_by_voice.ipynb)
